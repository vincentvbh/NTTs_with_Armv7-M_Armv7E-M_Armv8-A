
#include "NTT_params.h"

#include "tools.h"
#include "gen_table.h"

#include <stdio.h>
#include <stdlib.h>

const int streamlined_Rmod_root_table[NTT_N] = {
1, 1, -2810655, 1, -4834751, -4344944, -7582067, 9502507, 9502507, -4834751, 9502507, -4834751, -4344944, -7582067, -4834751, -4344944, -7582067, -3557352, -3156002, -4272400, 7931268, -4344944, -3557352, -3156002, -1462021, -990518, -387200, -1125323, -7582067, -4272400, 7931268, -9987341, 8616331, -6902944, 6121595, -3557352, -1462021, -990518, -8754049, 7837335, -3069995, 3982062, -3156002, -387200, -1125323, 7319852, -7790062, 8877966, -6190987, -4272400, -9987341, 8616331, -4454565, 8514599, -2552118, -416035, 7931268, -6902944, 6121595, -2453875, -6849828, 7879558, -408422, 9502507, 9502507, -4834751, 9502507, -4834751, -4344944, -7582067, -4834751, -4344944, -7582067, -3557352, -3156002, -4272400, 7931268, -4344944, -3557352, -3156002, -1462021, -990518, -387200, -1125323, -7582067, -4272400, 7931268, -9987341, 8616331, -6902944, 6121595, -3557352, -1462021, -990518, -8754049, 7837335, -3069995, 3982062, -3156002, -387200, -1125323, 7319852, -7790062, 8877966, -6190987, -4272400, -9987341, 8616331, -4454565, 8514599, -2552118, -416035, 7931268, -6902944, 6121595, -2453875, -6849828, 7879558, -408422, -1462021, -8754049, 7837335, -7069155, -8120860, -6645682, 8010252, -990518, -3069995, 3982062, -4986285, 9594359, 7057804, 2254707, -387200, 7319852, -7790062, -6440107, 931681, -624311, -3981190, -1125323, 8877966, -6190987, 6939956, 4124108, -9003437, 6359508, -9987341, -4454565, 8514599, 94794, 10010309, 826339, 7117169, 8616331, -2552118, -416035, 9228986, 211374, 147667, 5266952, -6902944, -2453875, -6849828, 6990379, 4598375, -255983, 4683585, 6121595, 7879558, -408422, -5623233, -7270194, -4086411, 3244519, -8754049, -7069155, -8120860, -2687026, 6332867, -567973, -9780470, 7837335, -6645682, 8010252, 173518, -1269570, -1484307, 5098323, -3069995, -4986285, 9594359, 8303904, -3513212, -6495697, -3205467, 3982062, 7057804, 2254707, -4029800, -5320562, -8833146, 1155220, 7319852, -6440107, 931681, -5086367, -6021977, -447288, 1984435, -7790062, -624311, -3981190, 1377106, 9622157, -7255866, -6216054, 8877966, 6939956, 4124108, 1720279, 84662, -8593517, 8864453, -6190987, -9003437, 6359508, 6507124, -3342630, -9186187, 1372668, -4454565, 94794, 10010309, -1668831, -3435691, -331164, -3128019, 8514599, 826339, 7117169, 3435615, -9374134, -7240812, -6396465, -2552118, 9228986, 211374, 6506777, 6216111, 918532, 4123841, -416035, 147667, 5266952, -8960525, -7867170, -332091, 6926829, -2453875, 6990379, 4598375, 8568410, -1021739, -2775967, 3353197, -6849828, -255983, 4683585, 9940768, -5792834, 9311114, -1630897, 7879558, -5623233, -7270194, -1937787, 7245173, -3880412, -8498145, -408422, -4086411, 3244519, 3602422, -359160, 9915377, -4506220, -7069155, -2687026, 6332867, -1110363, 2854170, -8650938, 431042, -8120860, -567973, -9780470, 1998579, 2779696, -4109166, -359943, -6645682, 173518, -1269570, 8096338, 6343730, -2630935, -9418983, 8010252, -1484307, 5098323, -5611883, 1406614, 6329759, 6316764, -4986285, 8303904, -3513212, 5992793, -6348428, 55955, 4345276, 9594359, -6495697, -3205467, 5780269, -4114225, -6975439, -6276964, 7057804, -4029800, -5320562, -7722882, -5117847, -1440269, 4963489, 2254707, -8833146, 1155220, -9153366, 1015418, -4491511, -6158357, -6440107, -5086367, -6021977, 7062959, -593658, 3157546, 2614776, 931681, -447288, 1984435, 7941977, 3819293, 9910871, 5106373, -624311, 1377106, 9622157, -5517087, 5795613, 545957, 1415922, -3981190, -7255866, -6216054, -2676861, 5790052, -7015872, 1701307, 6939956, 1720279, 84662, 8031492, 3047233, 4492152, -4831281, 4124108, -8593517, 8864453, 8020755, 1720468, -9917158, 514078, -9003437, 6507124, -3342630, 9056526, 5501798, 5669607, 419558, 6359508, -9186187, 1372668, 4136796, 3436873, 773456, -272030, 94794, -1668831, -3435691, 4681788, 995215, 7012951, -555676, 10010309, -331164, -3128019, 7258009, -1271264, -245806, -9467537, 826339, 3435615, -9374134, 8676593, 692885, -581729, 3928397, 7117169, -7240812, -6396465, -2907625, 9750411, -7742134, 4134196, 9228986, 6506777, 6216111, -4201318, 8113848, 1843098, 9538591, 211374, 918532, 4123841, -5725791, -4950535, 3224537, -7197355, 147667, -8960525, -7867170, 8971046, -7410728, 4332721, -1978392, 5266952, -332091, 6926829, -1677083, -7755240, -9003266, 8606775, 6990379, 8568410, -1021739, 9026788, -7982527, 7839731, -5644629, 4598375, -2775967, 3353197, -6732491, 8340916, 6978171, -6882803, -255983, 9940768, -5792834, -3738941, 8173842, 3968411, 3333829, 4683585, 9311114, -1630897, 2761825, 8812638, 3607131, 2932319, -5623233, -1937787, 7245173, 5003847, 3065593, -5795520, -5353813, -7270194, -3880412, -8498145, 7593954, 3976604, 5556706, 589797, -4086411, 3602422, -359160, -8117963, -7098968, 68465, -8089683, 3244519, 9915377, -4506220, -5373822, 10040780, 3240853, 6736505
};

const int streamlined_Rmod_inv_GS_root_table[NTT_N] = {
9502507, 9502507, 4834751, 9502507, 4834751, 7582067, 4344944, 9502507, 9502507, 4834751, 9502507, 4834751, 7582067, 4344944, 4834751, 7582067, 4344944, -7931268, 4272400, 3156002, 3557352, 7582067, -7931268, 4272400, -6121595, 6902944, -8616331, 9987341, 4344944, 3156002, 3557352, 1125323, 387200, 990518, 1462021, -7931268, -6121595, 6902944, 408422, -7879558, 6849828, 2453875, 4272400, -8616331, 9987341, 416035, 2552118, -8514599, 4454565, 3156002, 1125323, 387200, 6190987, -8877966, 7790062, -7319852, 3557352, 990518, 1462021, -3982062, 3069995, -7837335, 8754049, 9502507, 9502507, 4834751, 9502507, 4834751, 7582067, 4344944, 4834751, 7582067, 4344944, -7931268, 4272400, 3156002, 3557352, 7582067, -7931268, 4272400, -6121595, 6902944, -8616331, 9987341, 4344944, 3156002, 3557352, 1125323, 387200, 990518, 1462021, -7931268, -6121595, 6902944, 408422, -7879558, 6849828, 2453875, 4272400, -8616331, 9987341, 416035, 2552118, -8514599, 4454565, 3156002, 1125323, 387200, 6190987, -8877966, 7790062, -7319852, 3557352, 990518, 1462021, -3982062, 3069995, -7837335, 8754049, -6121595, 408422, -7879558, -3244519, 4086411, 7270194, 5623233, 6902944, 6849828, 2453875, -4683585, 255983, -4598375, -6990379, -8616331, 416035, 2552118, -5266952, -147667, -211374, -9228986, 9987341, -8514599, 4454565, -7117169, -826339, -10010309, -94794, 1125323, 6190987, -8877966, -6359508, 9003437, -4124108, -6939956, 387200, 7790062, -7319852, 3981190, 624311, -931681, 6440107, 990518, -3982062, 3069995, -2254707, -7057804, -9594359, 4986285, 1462021, -7837335, 8754049, -8010252, 6645682, 8120860, 7069155, 408422, -3244519, 4086411, 4506220, -9915377, 359160, -3602422, -7879558, 7270194, 5623233, 8498145, 3880412, -7245173, 1937787, 6849828, -4683585, 255983, 1630897, -9311114, 5792834, -9940768, 2453875, -4598375, -6990379, -3353197, 2775967, 1021739, -8568410, 416035, -5266952, -147667, -6926829, 332091, 7867170, 8960525, 2552118, -211374, -9228986, -4123841, -918532, -6216111, -6506777, -8514599, -7117169, -826339, 6396465, 7240812, 9374134, -3435615, 4454565, -10010309, -94794, 3128019, 331164, 3435691, 1668831, 6190987, -6359508, 9003437, -1372668, 9186187, 3342630, -6507124, -8877966, -4124108, -6939956, -8864453, 8593517, -84662, -1720279, 7790062, 3981190, 624311, 6216054, 7255866, -9622157, -1377106, -7319852, -931681, 6440107, -1984435, 447288, 6021977, 5086367, -3982062, -2254707, -7057804, -1155220, 8833146, 5320562, 4029800, 3069995, -9594359, 4986285, 3205467, 6495697, 3513212, -8303904, -7837335, -8010252, 6645682, -5098323, 1484307, 1269570, -173518, 8754049, 8120860, 7069155, 9780470, 567973, -6332867, 2687026, -3244519, 4506220, -9915377, -6736505, -3240853, -10040780, 5373822, 4086411, 359160, -3602422, 8089683, -68465, 7098968, 8117963, 7270194, 8498145, 3880412, -589797, -5556706, -3976604, -7593954, 5623233, -7245173, 1937787, 5353813, 5795520, -3065593, -5003847, -4683585, 1630897, -9311114, -2932319, -3607131, -8812638, -2761825, 255983, 5792834, -9940768, -3333829, -3968411, -8173842, 3738941, -4598375, -3353197, 2775967, 6882803, -6978171, -8340916, 6732491, -6990379, 1021739, -8568410, 5644629, -7839731, 7982527, -9026788, -5266952, -6926829, 332091, -8606775, 9003266, 7755240, 1677083, -147667, 7867170, 8960525, 1978392, -4332721, 7410728, -8971046, -211374, -4123841, -918532, 7197355, -3224537, 4950535, 5725791, -9228986, -6216111, -6506777, -9538591, -1843098, -8113848, 4201318, -7117169, 6396465, 7240812, -4134196, 7742134, -9750411, 2907625, -826339, 9374134, -3435615, -3928397, 581729, -692885, -8676593, -10010309, 3128019, 331164, 9467537, 245806, 1271264, -7258009, -94794, 3435691, 1668831, 555676, -7012951, -995215, -4681788, -6359508, -1372668, 9186187, 272030, -773456, -3436873, -4136796, 9003437, 3342630, -6507124, -419558, -5669607, -5501798, -9056526, -4124108, -8864453, 8593517, -514078, 9917158, -1720468, -8020755, -6939956, -84662, -1720279, 4831281, -4492152, -3047233, -8031492, 3981190, 6216054, 7255866, -1701307, 7015872, -5790052, 2676861, 624311, -9622157, -1377106, -1415922, -545957, -5795613, 5517087, -931681, -1984435, 447288, -5106373, -9910871, -3819293, -7941977, 6440107, 6021977, 5086367, -2614776, -3157546, 593658, -7062959, -2254707, -1155220, 8833146, 6158357, 4491511, -1015418, 9153366, -7057804, 5320562, 4029800, -4963489, 1440269, 5117847, 7722882, -9594359, 3205467, 6495697, 6276964, 6975439, 4114225, -5780269, 4986285, 3513212, -8303904, -4345276, -55955, 6348428, -5992793, -8010252, -5098323, 1484307, -6316764, -6329759, -1406614, 5611883, 6645682, 1269570, -173518, 9418983, 2630935, -6343730, -8096338, 8120860, 9780470, 567973, 359943, 4109166, -2779696, -1998579, 7069155, -6332867, 2687026, -431042, 8650938, -2854170, 1110363
};

#define BUFF_MAX (NTT_N << 3)

struct compress_profile profile;

int main(){

    profile.compressed_layers = 3;
    for(size_t i = 0; i < profile.compressed_layers; i++){
        profile.merged_layers[i] = 3;
    }

    int32_t buff[BUFF_MAX];

    int32_t buff2[BUFF_MAX];

    int32_t omega_int32;
    int32_t scale_int32;
    int32_t mod_int32;

    scale_int32 = 1;
    mod_int32 = Q1;
    omega_int32 = omegaQ1;
    gen_streamlined_CT_table_generic(
        buff2,
        &scale_int32, &omega_int32,
        &mod_int32,
        sizeof(int32_t),
        mulmod_int32,
        &profile, 0
    );

    scale_int32 = RmodQ1;
    mod_int32 = Q1;
    omega_int32 = omegaQ1;
    gen_streamlined_CT_table_generic(
        buff,
        &scale_int32, &omega_int32,
        &mod_int32,
        sizeof(int32_t),
        mulmod_int32,
        &profile, 0
    );

    for(size_t i = 0; i < 4; i++){
        buff[i] = buff2[i];
    }

    for(size_t i = 0; i < NTT_N - 1; i++){
        printf("%d, ", buff[i]);
        // assert(streamlined_Rmod_root_table[i] == buff[i]);
    }
    printf("\n");

    scale_int32 = RmodQ1;
    mod_int32 = Q1;
    omega_int32 = invomegaQ1;
    gen_streamlined_CT_table_generic(
        buff,
        &scale_int32, &omega_int32,
        &mod_int32,
        sizeof(int32_t),
        mulmod_int32,
        &profile, 0
    );

    for(size_t i = 0; i < NTT_N - 1; i++){
        printf("%d, ", buff[i]);
        // assert(streamlined_Rmod_inv_GS_root_table[i] == buff[i]);
    }
    printf("\n");


}





